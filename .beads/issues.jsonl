{"id":"loaa-2ak","content_hash":"234d637ad8d3e3441d574be7d03b1c0f1ded67496a628faa900231c445e7923b","title":"Design and implement UI components","description":"","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-09T18:58:19.47879-10:00","updated_at":"2025-11-09T18:58:19.47879-10:00","source_repo":"."}
{"id":"loaa-3z2","content_hash":"c3f4c345996d863b8c44b2f7a592f4e61387b004b0744f98148f68a3a995a3a5","title":"Build task CRUD operations","description":"","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-09T18:58:18.964676-10:00","updated_at":"2025-11-09T18:58:18.964676-10:00","source_repo":"."}
{"id":"loaa-4ve","content_hash":"e6832a7eb5ec33dac8afa309eff46e68bfd53ddbfd1fcf1120bdeb4c02cc828c","title":"Implement task completion workflow","description":"","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-09T18:58:19.134913-10:00","updated_at":"2025-11-09T18:58:19.134913-10:00","source_repo":"."}
{"id":"loaa-han","content_hash":"b4552e5b8fcce83b9c2b10098a74029be3e6eaeee6ad116c68af598d70656b08","title":"Build MCP server with core operations","description":"","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-09T18:58:19.304982-10:00","updated_at":"2025-11-09T18:58:19.304982-10:00","source_repo":"."}
{"id":"loaa-kmk","content_hash":"4c7b14d77894d671619111b463a45b55e56ecc531fcff94ff5d3e8260255b05a","title":"Design core data models (Task, Kid, Ledger)","description":"## Overview\n\nDesign and implement the core data models that represent the domain concepts of Loa'a. These models form the foundation for all business logic and will be used across web, MCP, and future components.\n\n## Goals\n\n- Define Rust structs for all Phase 1 entities\n- Implement serialization/deserialization\n- Add validation logic\n- Create helper methods for common operations\n- Document the data model design\n\n## Core Entities for Phase 1\n\n### Kid\n\nRepresents a child in the household.\n\n```rust\nstruct Kid {\n    id: Uuid,\n    name: String,\n    created_at: DateTime\u003cUtc\u003e,\n    updated_at: DateTime\u003cUtc\u003e,\n}\n```\n\n**Validation:**\n- Name must be non-empty\n- Name should be unique (helper to check)\n\n### Task\n\nRepresents a chore or activity that can be completed for money.\n\n```rust\nstruct Task {\n    id: Uuid,\n    name: String,\n    description: String,\n    value: Decimal,           // Monetary value in dollars\n    cadence: Cadence,         // How often it resets\n    last_reset: DateTime\u003cUtc\u003e,\n    created_at: DateTime\u003cUtc\u003e,\n    updated_at: DateTime\u003cUtc\u003e,\n}\n\nenum Cadence {\n    Daily,\n    Weekly,\n    OneTime,\n}\n```\n\n**Validation:**\n- Name must be non-empty\n- Value must be positive\n- Description can be empty\n\n**Helper Methods:**\n- `needs_reset() -\u003e bool` - Check if task should reset based on cadence\n- `reset()` - Update last_reset timestamp\n\n### LedgerEntry\n\nRepresents a transaction in a kid's ledger.\n\n```rust\nstruct LedgerEntry {\n    id: Uuid,\n    kid_id: Uuid,\n    amount: Decimal,\n    entry_type: EntryType,\n    description: String,\n    created_at: DateTime\u003cUtc\u003e,\n}\n\nenum EntryType {\n    Earned,     // Money earned from task completion\n    Adjusted,   // Manual correction by parent\n}\n```\n\n**Validation:**\n- kid_id must reference existing Kid\n- amount can be positive (earned) or negative (correction)\n- description can be empty\n\n**Helper Methods:**\n- None needed yet\n\n### Ledger (Aggregate)\n\nNot stored directly, but calculated from LedgerEntry records.\n\n```rust\nstruct Ledger {\n    kid_id: Uuid,\n    balance: Decimal,\n    entries: Vec\u003cLedgerEntry\u003e,\n}\n\nimpl Ledger {\n    fn calculate_balance(entries: \u0026[LedgerEntry]) -\u003e Decimal {\n        entries.iter()\n            .map(|e| e.amount)\n            .sum()\n    }\n}\n```\n\n## Tasks\n\n### 1. Create Models Module\n\nIn `crates/core/src/models/`:\n- `mod.rs` - Re-exports all models\n- `kid.rs` - Kid struct and impl\n- `task.rs` - Task, Cadence structs and impl\n- `ledger.rs` - LedgerEntry, EntryType, Ledger structs and impl\n- `common.rs` - Shared types (if needed)\n\n### 2. Add Dependencies\n\nUpdate `crates/core/Cargo.toml`:\n- `uuid` for IDs\n- `chrono` for timestamps\n- `rust_decimal` for monetary values (avoid floating point\\!)\n- `serde` for serialization\n\n### 3. Implement Serde Traits\n\nAll structs need:\n- `#[derive(Serialize, Deserialize)]`\n- Proper handling of Decimal serialization\n- DateTime serialization (ISO 8601)\n\n### 4. Add Validation\n\nCreate validation methods:\n- `Kid::validate(\u0026self) -\u003e Result\u003c()\u003e`\n- `Task::validate(\u0026self) -\u003e Result\u003c()\u003e`\n- `LedgerEntry::validate(\u0026self) -\u003e Result\u003c()\u003e`\n\n### 5. Write Tests\n\nTest files in `crates/core/src/models/`:\n- Test struct creation\n- Test validation logic\n- Test helper methods\n- Test serialization round-trip\n\n### 6. Document Design\n\nAdd `docs/data-models.md` with:\n- ER diagram (text-based)\n- Relationships between entities\n- Future extensions (Phase 2+ models)\n\n## Acceptance Criteria\n\n- [ ] All Phase 1 models defined in `loaa-core`\n- [ ] Structs derive Debug, Clone, Serialize, Deserialize\n- [ ] Validation methods exist and have tests\n- [ ] Helper methods work correctly\n- [ ] Documentation explains model design\n- [ ] No database-specific code (stays generic)\n\n## Design Decisions\n\n**Why Decimal for money:**\n- Floating point causes rounding errors\n- Decimal gives exact precision\n- Industry standard for financial calculations\n\n**Why UUIDs:**\n- Globally unique, no coordination needed\n- Easy to generate client-side\n- Better than auto-increment for distributed systems (future-proof)\n\n**Why separate EntryType enum:**\n- Clear intent (earned vs adjustment)\n- Extensible (can add Redeemed in Phase 5)\n- Makes queries easier (filter by type)\n\n**Why not a Balance table:**\n- Balance is derived, not stored\n- Source of truth is transaction history\n- Avoids sync issues\n\n**Why last_reset on Task:**\n- Simple approach for MVP\n- Can track when task was last available\n- Alternative: separate TaskInstance table (too complex for MVP)\n\n## Future Extensions (Not Now)\n\nThese will be added in later phases:\n\n**Phase 2:**\n- `User` - Authentication\n- `TaskCompletion` - Approval workflow\n- `Session` - Login sessions\n\n**Phase 3:**\n- `TaskPrerequisite` - Task dependencies\n\n**Phase 4:**\n- `BountyRule` - Dynamic value increases\n\n**Phase 5:**\n- `Reward` - Redeemable rewards\n- `Redemption` - Reward redemption records\n- Add `EntryType::Redeemed`\n\n## References\n\n- rust_decimal docs: https://docs.rs/rust_decimal/\n- chrono docs: https://docs.rs/chrono/\n- Domain-driven design principles\n\n## Dependencies\n\nShould be done after:\n- Basic project structure exists (already done)\n\nCan be done in parallel with:\n- loaa-ycs (Leptos setup)\n- loaa-p1z (SurrealDB setup)\n\n## Success Metrics\n\nWhen done:\n- Models compile without warnings\n- Tests pass\n- Models feel natural to work with\n- Clear path to implement business logic\n- Easy to extend in future phases","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-09T18:58:18.653667-10:00","updated_at":"2025-11-10T01:23:03.767901-10:00","closed_at":"2025-11-10T01:23:03.767901-10:00","source_repo":"."}
{"id":"loaa-p1z","content_hash":"311e8e0f9b8c6ae0f543c793f6b891de0e84e4b8405cb92796a02ca86a7099b1","title":"Integrate SurrealDB in embedded mode","description":"## Overview\n\nIntegrate SurrealDB in embedded mode as the primary database for Loa'a. This provides a local, zero-config database without requiring a separate server process.\n\n## Goals\n\n- Get SurrealDB embedded mode working\n- Create basic database connection\n- Verify CRUD operations work\n- Establish database abstraction in `loaa-core`\n- Set up database file storage location\n\n## Tasks\n\n### 1. Add SurrealDB Dependencies\n\nUpdate `crates/core/Cargo.toml` with:\n- `surrealdb` with embedded features\n- Choose storage backend (RocksDB or SpeedeDB)\n- Add async runtime support\n\n### 2. Create Database Module\n\nIn `crates/core/src/db/`:\n- `mod.rs` - Database connection and initialization\n- `connection.rs` - SurrealDB client wrapper\n- Error types and Result aliases\n\n### 3. Initialize Embedded Database\n\n- Configure database path (`.data/db/` in project root)\n- Set up namespace and database\n- Create connection pool if needed\n- Handle startup and shutdown\n\n### 4. Test Basic Operations\n\nWrite tests that prove:\n- Can connect to embedded DB\n- Can create/read/update/delete records\n- Can query with SurrealQL\n- Database file persists between restarts\n\n### 5. Update devenv/gitignore\n\n- Add database files to `.gitignore`\n- Document database location in README\n- Add any needed system dependencies to `devenv.nix`\n\n## Acceptance Criteria\n\n- [ ] SurrealDB embedded mode initializes on startup\n- [ ] Can create records and query them\n- [ ] Database file exists on disk\n- [ ] Data persists after restart\n- [ ] Tests pass for basic CRUD operations\n- [ ] No separate database server required\n\n## Technical Decisions\n\n**Storage Backend:**\n- **RocksDB** (default) - Battle-tested, good performance\n- **SpeedeDB** - Newer, potentially faster\n- **Decision**: Start with RocksDB (more mature)\n\n**Database Location:**\n- `loaa/.data/db/` - Keeps data separate from code\n- Gitignored\n- Can be backed up separately\n\n**Connection Strategy:**\n- Singleton connection for now (single-user)\n- Connection pool might be needed later for multi-user\n\n**Schema Mode:**\n- Start schemaless for rapid iteration\n- Add schema validation in later phases\n\n## Example Code Structure\n\n```rust\n// In loaa-core/src/db/mod.rs\npub struct Database {\n    client: Surreal\u003cDb\u003e,\n}\n\nimpl Database {\n    pub async fn init(path: \u0026str) -\u003e Result\u003cSelf\u003e {\n        let db = Surreal::new::\u003cRocksDb\u003e(path).await?;\n        db.use_ns(\"loaa\").use_db(\"main\").await?;\n        Ok(Self { client: db })\n    }\n    \n    pub async fn create\u003cT\u003e(\u0026self, table: \u0026str, data: T) -\u003e Result\u003cT\u003e {\n        // CRUD operations\n    }\n}\n```\n\n## References\n\n- SurrealDB embedded docs: https://surrealdb.com/docs/surrealdb/integration/sdks/rust\n- RocksDB backend: https://docs.rs/surrealdb/latest/surrealdb/engine/local/struct.RocksDb.html\n- SurrealQL reference: https://surrealdb.com/docs/surrealql\n\n## Dependencies\n\nNone - foundational work\n\n## Blockers\n\n**Potential Issues:**\n- SurrealDB compilation time (Rust dependencies can be slow)\n- Platform-specific build requirements\n- Limited documentation for embedded mode\n\n**Mitigation:**\n- If compilation is too slow, consider SQLite instead\n- Check platform requirements early\n- Consult SurrealDB Discord for help\n\n## Experimentation Notes\n\nWe're choosing SurrealDB partly to experiment with it. If we encounter issues:\n- Migration path to SQLite is straightforward\n- Keep database abstraction in `loaa-core` to make swap easier\n- Document learnings for future projects\n\n## Success Metrics\n\nWhen done:\n- DB initializes in \u003c1 second\n- CRUD operations work\n- Clear error messages\n- Database abstraction is clean and testable\n- Confident we can build on this foundation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-09T18:58:18.510189-10:00","updated_at":"2025-11-10T01:23:09.134287-10:00","closed_at":"2025-11-10T01:23:09.134287-10:00","source_repo":"."}
{"id":"loaa-pzn","content_hash":"a0f5fbbb983da64acac241c26822279b2a8950494b9d2f02ca6d67eff8341489","title":"Implement basic authentication system","description":"","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-09T18:58:18.79563-10:00","updated_at":"2025-11-09T18:58:18.79563-10:00","source_repo":"."}
{"id":"loaa-ycs","content_hash":"dee690ce715949f148648741ec1930bfa9ba9fbff7633fdb4662d1d7681e5432","title":"Set up Leptos web application with SSR","description":"## Overview\n\nSet up the Leptos web framework with server-side rendering (SSR) to serve as the foundation for the Loa'a web application.\n\n## Goals\n\n- Get Leptos working with SSR and hydration\n- Serve a basic \"Hello World\" page\n- Set up Axum as the server\n- Configure hot reload for development\n- Verify the full-stack Rust setup works\n\n## Tasks\n\n### 1. Add Leptos Dependencies\n\nUpdate `crates/web/Cargo.toml` with:\n- `leptos` with SSR feature\n- `leptos_axum` for server integration\n- `axum` for HTTP server\n- `tokio` for async runtime\n- `tower` and `tower-http` for middleware\n\n### 2. Create Basic Leptos App\n\nIn `crates/web/src/`:\n- `app.rs` - Main Leptos component\n- `main.rs` - Axum server setup\n- Basic routing\n- SSR configuration\n\n### 3. Configure Development Workflow\n\n- Set up `leptos` CLI config or cargo-leptos\n- Configure hot reload\n- Add npm/pnpm if needed for CSS/JS bundling\n- Update `justfile` with dev server command\n\n### 4. Create Hello World Page\n\nSimple page that proves:\n- Server renders initial HTML\n- Client hydrates and becomes interactive\n- Routing works\n- Can pass data server â†’ client\n\n## Acceptance Criteria\n\n- [ ] `cargo run -p loaa-web` starts web server\n- [ ] Browser shows a page (not 404 or error)\n- [ ] Page hydrates (console shows no hydration errors)\n- [ ] Can navigate between routes\n- [ ] Hot reload works (changes appear without full restart)\n\n## Technical Notes\n\n**Leptos SSR Modes:**\n- We want SSR with hydration (not CSR-only or SSR-only)\n- This gives fast initial load + interactive UI\n\n**Server Framework:**\n- Use Axum (modern, async, integrates well with Leptos)\n- Leptos provides `leptos_axum` integration crate\n\n**Styling:**\n- Start with basic CSS\n- Consider Tailwind or styled components later\n\n## References\n\n- Leptos Book: https://book.leptos.dev/\n- Leptos examples: https://github.com/leptos-rs/leptos/tree/main/examples\n- Leptos Axum integration docs\n\n## Dependencies\n\nNone - this is foundational work\n\n## Blockers\n\nNone known. If Leptos setup is too complex, we can pivot to Axum + HTMX (see roadmap.md).\n\n## Success Metrics\n\nWhen done, we should have:\n- Working dev server with hot reload\n- Basic page that renders and hydrates\n- Clear path to add more components\n- Confidence that Leptos is the right choice","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-09T18:58:18.363531-10:00","updated_at":"2025-11-10T01:23:15.020923-10:00","closed_at":"2025-11-10T01:23:15.020923-10:00","source_repo":"."}
